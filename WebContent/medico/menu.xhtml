<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/es/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">

<h:head>

	<style type="text/css">
.value {
	width: 1000px;
}
</style>
</h:head>
<body>
	<div id="menu">
		<h:form>
			<p:growl id="messages" showDetail="true" />
			<p:menubar>
				<p:menuitem>
					<p:graphicImage value="resources/images/logo1.png"></p:graphicImage>
				</p:menuitem>
				<p:menuitem value="Inicio" title="Inicio" icon="fa fa-home"
					action="menu?faces-redirect=true"></p:menuitem>

				<f:facet name="options">
					<p:commandButton title="Datos de usuario" icon="fa fa-user"
						value="#{authBeanLogin.login.nombres}" />
					<p:commandButton title="Cerrar sesión" icon="fa fa-power-off"
						action="#{authBeanLogin.actionCerrarSesion()}" />
				</f:facet>
			</p:menubar>
		</h:form>
	</div>
	<h:form id="formCitaFecha">
		<h:panelGrid columns="3" cellpadding="5">
			<p:outputLabel for="fecha" value="Fecha:" />
			<p:calendar id="fecha" value="#{reserBeanCita.fecha}" showOn="button"
				mindate="#{reserBeanCita.minFecha}" required="true"
				requiredMessage="Seleccione un día" />

			<p:commandButton update=":formCitas"
				action="#{reserBeanCita.actionGetCitasDocFecha()}" value="Ver citas" />
		</h:panelGrid>
		<hr></hr>
	</h:form>

	<div align="center">
		<p:panel header="Bienvenido Médico">
			<div align="center">
				<h1>Citas</h1>
			</div>
			<h:form id="formCitas">
				<p:dataGrid var="cita" value="#{reserBeanCita.listCitasDocFecha}"
					emptyMessage="No se encontraron citas" rows="6" paginator="true"
					rowsPerPageTemplate="6,12,16"
					paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					gridIcon="pi pi-th-large" listIcon="pi pi-bars">
					<p:dataViewListItem>
						<h:panelGrid columns="1" style="width:100%">
							<p:outputPanel>
								<h:panelGrid columns="2" cellpadding="5">
									<h:outputText value="Asunto:" />
									<h:outputText value="#{cita.asuntoReser}"
										style="font-weight: bold" />


									<h:outputText value="Fecha:" />
									<h:outputText value="#{cita.fechaReser}"
										style="font-weight: bold" />

									<h:outputText value="Hora:" />
									<h:outputText value="#{cita.horaReser}"
										style="font-weight: bold" />

									<h:outputText value="Paciente:" />
									<h:outputText
										value="#{cita.pacPaciente.nombresPac} #{cita.pacPaciente.apellidosPac}"
										style="font-weight: bold" />
								</h:panelGrid>
							</p:outputPanel>
							<p:commandButton value="Atender"
								action="#{pacBeanHistoriaC.actionHistoriaClinica(cita)}"
								icon="fa fa-align-left" title="Atender">
								<!--  	<f:setPropertyActionListener value="#{cita.pacPaciente}" 
									target="#{reserBeanCita.paciente}" /> -->
							</p:commandButton>
							<p:commandButton value="Reagendar" icon="fa fa-calendar"
								oncomplete="PF('reagendarDialog').show()"
								title="Reagendar citas">
								<f:setPropertyActionListener value="#{cita}"
									target="#{reserBeanCita.selectedCita}" />
							</p:commandButton>
							<hr></hr>
						</h:panelGrid>
					</p:dataViewListItem>
				</p:dataGrid>
			</h:form>
			<p:dialog header="Reagendar cita" widgetVar="reagendarDialog"
				id="reagendarDialog" modal="true" height="450" width="600"
				responsive="true" appendTo="@(body)">

				<h:form id="form-medicos">
					<p:messages>
						<p:autoUpdate />
					</p:messages>
					<h:panelGrid columns="3" cellpadding="5">
						<p:outputLabel for="medico" value="Seleccione médico:" />
							<p:selectOneMenu id="medico" value="#{reserBeanCita.idMedicoSelect}"
								autoWidth="100%" required="true"
								requiredMessage="Seleccione un médico" effect="fade"
								filter="true" filterMatchMode="startsWith">
								<f:selectItem itemLabel="Seleccione un médico"
									noSelectionOption="true" />
								<f:selectItems value="#{reserBeanCita.listMedicos}" var="m"
									itemLabel="#{m.nombresMed}" itemValue="#{m.idMedico}" />
							</p:selectOneMenu>
					</h:panelGrid>
					<hr></hr>
				</h:form>

				<h:form id="form-mreserva">

					<h:panelGrid columns="3" cellpadding="5">
						<p:outputLabel for="fecha" value="Fecha:" />
						<p:calendar id="fecha" value="#{reserBeanCita.fecha}"
							showOn="button" mindate="#{reserBeanCita.minFecha}"
							required="true" requiredMessage="Seleccione un día" />

						<p:commandButton update=":dataHora"
							action="#{reserBeanCita.setHorasDisponibles()}"
							value="Ver horarios disponibles" />
					</h:panelGrid>
					<hr></hr>
				</h:form>
				<h:form id="dataHora">
					<div id="datosCita"
						style="display:#{(reserBeanCita.showDatosCita)?'none':'block'}">
						<h:panelGrid columns="2" cellpadding="5">

							<p:outputLabel for="hora2" value="Seleccione hora:" />
							<p:selectOneMenu id="hora2" value="#{reserBeanCita.horaSelect}"
								autoWidth="100%" required="true"
								requiredMessage="Seleccione una hora" effect="fade"
								filter="true" filterMatchMode="startsWith">
								<f:selectItem itemLabel="Seleccione una hora"
									noSelectionOption="true" />
								<f:selectItems value="#{reserBeanCita.listHoras}" var="h"
									itemLabel="#{h.hora}" itemValue="#{h.time}" />
							</p:selectOneMenu>
						</h:panelGrid>
						<p:commandButton value="Reagendar cita" 
							action="#{reserBeanCita.actionReagendar()}"
							 update=":formCitas" />
					</div>
				</h:form>
			</p:dialog>
		</p:panel>
	</div>


</body>
</html>
